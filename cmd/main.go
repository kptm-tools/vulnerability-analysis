package main

import (
	"fmt"

	"github.com/kptm-tools/common/common/events"
	"github.com/kptm-tools/vulnerability-analysis/pkg/handlers"
	"github.com/kptm-tools/vulnerability-analysis/pkg/services"
)

func main() {
	fmt.Println("Hello Vulnerability Analysis!")

	// Services
	nmapService := services.NewNmapService()

	// Handlers
	nmapHandler := handlers.NewNmapHandler(nmapService)

	nmapHandler.RunScan(events.ScanStartedEvent{
		ScanID: "49858928-0c12-4abc-bd4f-9b4814661ca6",
		Targets: []events.Target{
			{
				Alias: "i2linked",
				Value: "i2linked.com",
				Type:  events.Domain,
			},
		},
	})
}
