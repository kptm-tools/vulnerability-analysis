package interfaces

import (
	"context"

	"github.com/kptm-tools/common/common/enums"
	"github.com/kptm-tools/common/common/events"
	"github.com/kptm-tools/common/common/results"
)

type INmapService interface {
	RunScan(ctx context.Context, targets []string) ([]results.TargetResult, error)
}

type INmapHandler interface {
	RunScan(context.Context, events.ScanStartedEvent) <-chan ServiceResult
}

type ServiceResult struct {
	ScanID      string
	ServiceName enums.ServiceName
	Result      []results.TargetResult
	Err         error
}
